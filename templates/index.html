{% extends "base.html" %}

{% block title %}
Index Page
{% endblock %}

{% block content %}
<ul>
  {% for person in people %}
  <li>
    {{ person.name }} ({{ person.age }})
    <button onclick="deletePerson({{ person.pid }})">Delete</button>
    <a href="{{ url_for('detail', pid=person.pid) }}">Details</a>
  </li>
  {% endfor %}
</ul>

<h3>New Person</h3>

<form method="POST" action="{{ url_for('index') }}">
  <input type="text" name="name" placeholder="name" required><br>
  <input type="number" name="age" placeholder="age"><br>
  <input type="submit" value="create">
</form>

<script type="text/javascript">
  function deletePerson(pid) {
    fetch(`/delete/${pid}`, {
      method: 'DELETE'
    })
    .then(response => {
      if (response.ok) {
        window.location.reload();
      } else {
        console.error('Failed to delete item with pid:', pid);
      }
    })
    .catch(error => {
      console.error('Error during fetch:', error);
    });
  }
</script>

{% endblock %}
